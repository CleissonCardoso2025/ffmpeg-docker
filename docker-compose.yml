# NAME: docker-compose.yml
# AUTH: Ryan McCartney <ryan@mccartney.info>
# DATE: 08/01/2023
# DESC: FFmpeg compiled with configurable options link BMD Decklink or Newtec NDI

version: "3.8"

services:
    ffmpeg:
        container_name: ffmpeg
        build:
            context: "."
            args:
                DECKLINK_SUPPORT: "true"
                DECLINK_SDK_URL: "https://sw.blackmagicdesign.com/DeckLink/v12.4.1/Blackmagic_DeckLink_SDK_12.4.1.zip?Key-Pair-Id=APKAJTKA3ZJMJRQITVEA&Signature=DTYZdAlFL1IrzS55D92Z+Yedy2Z8eTlBU/GyQHcuoH7SA1bEeibpT9DT/xXd0/E0uZTQZMuiS9Ejrvvr4YTsG/4Rx/GJU4yNrBb6AXZG9WYsSrxhCRYdIN+osEZgAuYv6eaCGr3f9J+ucCzqfTpJNmM940IsHm50VIx6hKr6d4ZBJ9jBgRaiQjujNhtvzOdXD82FVUM5EIZG9bn92C5WPHDQ/z4qSOYUK+dLX1e9CYUgyHzRT2jt36XFBfzXJ6Unmskie3JkQEH/KrZ1x6tuPk3zhZErP24OICYiSN5yCv9xI/UB0ql3O3lU8XxaOOYg9kqRceNLVZdpb434yy0fcw==&Expires=1688740077"
                DECKLINK_DRIVER_URL: "https://sw.blackmagicdesign.com/DesktopVideo/v12.4.1/Blackmagic_Desktop_Video_Linux_12.4.1.tar.gz?Key-Pair-Id=APKAJTKA3ZJMJRQITVEA&Signature=hXBETsMc2AOjoEncSUdL/7LVRPpnyX1QxjM2X/qbckMlTwwyVGE+cBWWigkF0POmjEhlzLmllxqLrpbuloNZFjZQKvz0o8Sv1+1lJpyJ82RwizKpFsMA0Q+OizWQ2R2uOe5QA4AaUHkGn5UHHESyMcPMmipedZMyheRJghbZEwCA39bumM3c80NzVGCct4dHtWd1QBXO3dS2RvCEuCb451wBpeqcl5QncAIgX2xSVefVMvDfB6634Lc2K8EtIFk/pnnC3K4xGZVZJvY/4TvIfl9u+kCo3hoc8M5uEjK5s0kXGCZWOV1oDOWnQlSXYFx5GBA8jdctM1car1NEUBMigQ==&Expires=1688740038"
                DECKLINK_DRIVER_VERSION: "12.4.1"
                NDI_SUPPORT: "true"
                NDI_SDK_URL: "https://downloads.ndi.tv/SDK/NDI_SDK_Linux/Install_NDI_SDK_v5_Linux.tar.gz"
        restart: always
        volumes:
            - ./:/home/node/app
        devices:
            - /dev/blackmagic/dv0:/dev/blackmagic/dv0
        environment:
            NODE_ENV: "development"
            PORT: 80
        ports:
            - 3000:80
            - 5004:5004
